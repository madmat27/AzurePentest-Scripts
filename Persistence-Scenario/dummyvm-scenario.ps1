$starttime = Get-Date
Write-Host -ForegroundColor Green "Deployment Started $starttime"

## Ανάθεση μεταβλητών
$group = "pentest-resgr-persistence"
$location = "ukwest"
$vmname = "dummyvm"
$image = "Win2019Datacenter"
$admin = "windowsadmin"
$pass = "myPassword123"

## Δημιουργία resource group
az group create --name $group --location $location

## Δημιουργία VM με public ip.
az vm create --resource-group $group --name $vmname --image $image --public-ip-sku Standard --admin-username $admin --admin-password $pass

## Ορίζουμε τις θύρες που επιθυμούμε να είναι ανοιχτές
az vm open-port --port 3389 --resource-group $group --name $vmname

## Έξοδος των δεδομένων που μας ενδιαφέρουν από το script
Start-Transcript -Path dummyvm-scenario-output.txt
Write-Host -ForegroundColor Green "#################################"
Write-Host -ForegroundColor Green "# Script Output #"
Write-Host -ForegroundColor Green "#################################"
Write-Host -ForegroundColor Green "Resource Group " $group " created successfully"
Write-Host -ForegroundColor Green "Virtual Machine " $vmname " deployed successfully"
Write-Host -ForegroundColor Green " "
Stop-Transcript
$endtime = Get-Date
Write-Host -ForegroundColor Green "Deployment Ended $endtime"